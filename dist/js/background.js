var background=webpackJsonp_name_([3],{"7SDd":function(e,n,t){"use strict";var r=t("Xxa5"),a=t.n(r),s=t("exGp"),o=t.n(s),u=t("ZVky"),c=t.n(u);n.a={queryAnnotation:function(e,n){var t=c.a.Object.extend("Annotations"),r=new c.a.Query(t);return n?r.equalTo("objectId",n):r.equalTo("text",e),r.first()},updateAnnotation:function(e,n){return e.increment("numTrue",n[0]),e.increment("numFalse",n[1]),e.save()},createAnnotation:function(e,n){var t=c.a.Object.extend("Annotations"),r=new t;return r.set("text",e),r.set("numTrue",0),r.set("numFalse",0),this.updateAnnotation(r,n)},saveAnnotation:function(e,n,t){var r=this;return o()(a.a.mark(function s(){var o;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,r.queryAnnotation(e,n);case 3:return o=a.sent,a.next=6,o;case 6:if(!a.sent){a.next=10;break}a.t0=r.updateAnnotation(o,t),a.next=11;break;case 10:a.t0=r.createAnnotation(e,t);case 11:return a.abrupt("return",a.t0);case 14:a.prev=14,a.t1=a.catch(0),console.log(a.t1);case 17:case"end":return a.stop()}},s,r,[[0,14]])}))()},queryAllAnnotations:function(e){var n=c.a.Object.extend("Annotations"),t=new c.a.Query(n);return t.containedIn("text",e),t.find()},queryUserAnnotation:function(e,n){var t=c.a.Object.extend("UserAnnotations"),r=new c.a.Query(t);return r.equalTo("user",e),r.equalTo("annotation",n),r.first()},queryMultipleUserAnnotations:function(e,n){var t=c.a.Object.extend("UserAnnotations"),r=new c.a.Query(t);return r.equalTo("user",e),r.containedIn("annotation",n),r.find()},updateUserAnnotation:function(e,n){return e.set("vote",n),e.save()},createUserAnnotation:function(e,n,t){var r=c.a.Object.extend("UserAnnotations"),a=new r;return a.set("user",e),a.set("annotation",n),a.set("vote",0),this.updateUserAnnotation(a,t)},saveUserAnnotation:function(e,n,t){var r=this;return o()(a.a.mark(function s(){var o;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.queryUserAnnotation(e,n);case 2:if(!(o=a.sent)){a.next=11;break}if(0!==t){a.next=8;break}return a.abrupt("return",o.destroy());case 8:return a.abrupt("return",r.updateUserAnnotation(o,t));case 9:a.next=12;break;case 11:return a.abrupt("return",r.createUserAnnotation(e,n,t));case 12:case"end":return a.stop()}},s,r)}))()}}},YcCz:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("Xxa5"),a=t.n(r),s=t("exGp"),o=t.n(s),u=t("BO1k"),c=t.n(u),i=t("ZVky"),f=t.n(i),v=t("tj/9"),l=t("7SDd");f.a.initialize("truthchalk"),f.a.serverURL="http://truthchalk.us-east-1.elasticbeanstalk.com/parse",chrome.runtime.onMessage.addListener(function(e,n,t){switch(e.action){case"isLoggedIn":t({isLoggedIn:v.a.isLoggedIn()});break;case"saveAnnotation":l.a.saveAnnotation(e.text,e.id,e.increment,f.a.User.current()).then(function(n){return l.a.saveUserAnnotation(f.a.User.current(),n,e.vote)}).then(function(e){t({id:e.get("annotation").id})}).catch(function(e){return console.log(e)});break;case"queryTexts":l.a.queryAllAnnotations(e.texts).then(function(e){var n={},r=!0,a=!1,s=void 0;try{for(var o,u=c()(e);!(r=(o=u.next()).done);r=!0){var i=o.value;n[i.id]={text:i.get("text"),votes:[i.get("numTrue"),i.get("numFalse"),0]}}}catch(e){a=!0,s=e}finally{try{!r&&u.return&&u.return()}finally{if(a)throw s}}e&&l.a.queryMultipleUserAnnotations(f.a.User.current(),e).then(function(e){var r=!0,a=!1,s=void 0;try{for(var o,u=c()(e);!(r=(o=u.next()).done);r=!0){var i=o.value;n[i.get("annotation").id].votes[2]=i.get("vote")}}catch(e){a=!0,s=e}finally{try{!r&&u.return&&u.return()}finally{if(a)throw s}}t({texts:n})}).catch(function(e){return console.log(e)})})}return!0}),n.default={isLoggedIn:function(){return v.a.isLoggedIn()},logIn:function(e,n){var t=this;return o()(a.a.mark(function r(){var s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.logIn(e,n);case 2:return s=t.sent,chrome.tabs.query({},function(e){var n=!0,t=!1,r=void 0;try{for(var a,o=c()(e);!(n=(a=o.next()).done);n=!0){var u=a.value;chrome.tabs.sendMessage(u.id,{isLoggedIn:s.success})}}catch(e){t=!0,r=e}finally{try{!n&&o.return&&o.return()}finally{if(t)throw r}}}),t.abrupt("return",s);case 5:case"end":return t.stop()}},r,t)}))()},logOut:function(){var e=this;return o()(a.a.mark(function n(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.logOut();case 2:chrome.tabs.query({},function(e){var n=!0,t=!1,r=void 0;try{for(var a,s=c()(e);!(n=(a=s.next()).done);n=!0){var o=a.value;chrome.tabs.sendMessage(o.id,{isLoggedIn:!1})}}catch(e){t=!0,r=e}finally{try{!n&&s.return&&s.return()}finally{if(t)throw r}}});case 3:case"end":return e.stop()}},n,e)}))()},signUp:function(e,n,t){var r=this;return o()(a.a.mark(function s(){var o;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,v.a.signUp(e,n,t);case 2:return o=r.sent,chrome.tabs.query({},function(e){var n=!0,t=!1,r=void 0;try{for(var a,s=c()(e);!(n=(a=s.next()).done);n=!0){var u=a.value;chrome.tabs.sendMessage(u.id,{isLoggedIn:o.success})}}catch(e){t=!0,r=e}finally{try{!n&&s.return&&s.return()}finally{if(t)throw r}}}),r.abrupt("return",o);case 5:case"end":return r.stop()}},s,r)}))()}}},"tj/9":function(e,n,t){"use strict";var r=t("Xxa5"),a=t.n(r),s=t("exGp"),o=t.n(s),u=t("ZVky"),c=t.n(u);n.a={logIn:function(e,n){var t=this;return o()(a.a.mark(function r(){var s,o;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s={success:!0,message:""},t.prev=1,t.next=4,c.a.User.logIn(e.toLowerCase(),n);case 4:o=t.sent,console.log(o),t.next=12;break;case 8:switch(t.prev=8,t.t0=t.catch(1),s.success=!1,t.t0.code){case 101:s.message="Invalid email and password"}case 12:return t.abrupt("return",s);case 13:case"end":return t.stop()}},r,t,[[1,8]])}))()},logOut:function(){return c.a.User.logOut()},isLoggedIn:function(){return null!==c.a.User.current()},signUp:function(e,n,t){var r=this;return o()(a.a.mark(function s(){var o,u;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return c.a.User.current()&&c.a.User.logOut(),o=new c.a.User,n=n.toLowerCase(),o.set("username",n),o.set("email",n),o.set("password",t),o.set("nickname",e),u={success:!0},r.prev=8,r.next=11,o.signUp();case 11:r.next=24;break;case 13:r.prev=13,r.t0=r.catch(8),u={success:!1,message:""},r.t1=r.t0.code,r.next=209===r.t1?19:202===r.t1?21:125===r.t1?23:24;break;case 19:return u.message="Current user has not logged out",r.abrupt("break",24);case 21:return u.message="This email has been registered",r.abrupt("break",24);case 23:u.message="The email is invalid";case 24:return r.abrupt("return",u);case 25:case"end":return r.stop()}},s,r,[[8,13]])}))()}}}},["YcCz"]);