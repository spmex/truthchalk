var content=webpackJsonp_name_([2],{"2z8x":function(t,e,n){var i=n("wxXY");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var o=n("rjj0").default;o("033d4f82",i,!0,{})},"43+d":function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o});var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.hasUser?n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],ref:"popbar",style:t.position,attrs:{id:"tc-popbar"}},[n("el-button",{staticClass:"tc-popbar tc-button",class:{"tc-button-toggle":t.buttonTrue},attrs:{id:"tc-button-true",type:"primary"},on:{click:function(e){return"button"in e||!t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?"button"in e&&0!==e.button?null:(e.stopPropagation(),void t.toggleState(1)):null}}},[t._v("T | "+t._s(t.numTrue))]),n("el-button",{staticClass:"tc-popbar tc-button",class:{"tc-button-toggle":t.buttonFalse},attrs:{id:"tc-button-false",type:"primary"},on:{click:function(e){return"button"in e||!t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?"button"in e&&0!==e.button?null:(e.stopPropagation(),void t.toggleState(-1)):null}}},[t._v(t._s(t.numFalse)+" | F")])],1):t._e()},o=[]},CnAQ:function(t,e,n){"use strict";function i(t){n("2z8x")}var o=n("rs51"),s=n("43+d"),a=n("XyMi"),r=i,c=Object(a.a)(o.a,s.a,s.b,!1,r,null,null);e.a=c.exports},Uy9U:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("7+uW"),o=n("CnAQ"),s=n("zL8q"),a=n.n(s),r=n("tvR6"),c=(n.n(r),document.createElement("div"));document.body.appendChild(c),c.id="tc-popbar",i.default.config.productionTip=!1,i.default.use(a.a),new i.default({el:"#tc-popbar",render:function(t){return t(o.a)}})},rs51:function(t,e,n){"use strict";var i=n("Gu7T"),o=n.n(i),s=n("lHA8"),a=n.n(s),r=n("BO1k"),c=n.n(r),l=n("woOf"),h=n.n(l),u=n("5Nri"),g=n.n(u),d=n("nEyA"),p=(n.n(d),n("BjrR"));n.n(p);e.a={data:function(){return{state:0,originalState:0,numTrue:0,numFalse:0,target:null,range:null,position:{top:"0px",left:"0px"},isShow:!0,hasUser:!0}},computed:{buttonTrue:function(){return 1===this.state},buttonFalse:function(){return-1===this.state}},created:function(){var t=this;g.a.init(),document.body.addEventListener("mouseup",this.selectToShow),document.body.addEventListener("keyup",this.closeBar),chrome.runtime.onMessage.addListener(function(e,n,i){"isLoggedIn"in e&&(t.hasUser=e.isLoggedIn,t.hasUser?chrome.runtime.sendMessage({action:"queryTexts",texts:t.collectAllSentences()},function(e){return t.highlightExistingSentences(e.texts)}):t.removeAllHighlightSentences())}),this.isShow=!1},mounted:function(){var t=this;chrome.runtime.sendMessage({action:"isLoggedIn"},function(e){t.hasUser=e.isLoggedIn,t.hasUser&&chrome.runtime.sendMessage({action:"queryTexts",texts:t.collectAllSentences()},function(e){return t.highlightExistingSentences(e.texts)})})},beforeDestroy:function(){document.body.removeEventListener("mouseup",this.selectToShow),document.body.removeEventListener("keyup",this.closeBarByEsc)},methods:{resetData:function(){h()(this.$data,this.$options.data.call(this))},closeBarByEsc:function(t){27===t.keyCode&&(this.isShow=!1),t.stopPropagation()},selectToShow:function(t){if(this.hasUser){var e=g.a.getSelection();t.ctrlKey&&!this.isShow?0!==e.toString().length&&this.expandSelection(e)&&(this.show(t.pageX,t.pageY),t.stopPropagation()):this.$refs.popbar.contains(t.target)||this.hide()}},clickToShow:function(t){if(this.hasUser)if(this.isShow)this.hide();else if(0===g.a.getSelection().toString().length){for(var e=t.target;!e.classList.contains("tc-highlight");)e=e.parentNode;this.target=e,this.show(t.pageX,t.pageY,this.target),t.stopPropagation()}},show:function(t,e,n){this.isShow=!0;var i=Math.max(t-50,0),o=e-50;if(this.position.top=o.toString()+"px",this.position.left=i.toString()+"px",n){this.numTrue=parseInt(n.dataset.tcTrue),this.numFalse=parseInt(n.dataset.tcFalse);var s=parseInt(n.dataset.tcUser);0!==s&&(this.state=s)}this.originalState=this.state},hide:function(){if(this.originalState!==this.state){var t={action:"saveAnnotation",text:"",id:null,vote:this.state,increment:this.solveIncrement(this.originalState,this.state)},e=this.target;e&&e.classList.contains("tc-highlight")?(t.id=e.dataset.tcId,0===this.numTrue&&0===this.numFalse?this.removeHighlight(e):(this.applyHighlight(e,this.numTrue>=this.numFalse),this.updateTargetData(e))):(e=this.targetFromRange(this.range),this.applyHighlight(e,1===this.state),this.updateTargetData(e)),t.text=e.innerText,chrome.runtime.sendMessage(t,function(t){e&&(e.dataset.tcId=t.id)})}this.resetData(),this.isShow=!1},solveIncrement:function(t,e){return{"0,-1":[0,1],"1,-1":[-1,1],"-1,0":[0,-1],"0,1":[1,0],"-1,1":[1,-1],"1,0":[-1,0]}[[t,e]]},toggleState:function(t){var e=this.state;this.state=t===this.state?0:t;var n=this.solveIncrement(e,this.state);this.numTrue+=n[0],this.numFalse+=n[1]},expandSelection:function(t){var e=t.anchorNode,n=e.parentNode;if(0===t.toString().length||3!==e.nodeType||null===n)return!1;for(var i=new g.a.WrappedRange(window.getSelection().getRangeAt(0)),o=/[^.!?\s][^\n.!?]*\b[^.!?\s][^\n.!?]*\b[^.!?\s][^\n.!?]*(?:[.!?](?!['"]?\s|$)[^\n.!?]*)*[.!?]?['"]?(?=\s|$)/g,s=g.a.createRange(),a=void 0;null!=(a=o.exec(n.innerText));)if(s.selectCharacters(n,a.index,o.lastIndex),s.containsRange(i))return t.removeAllRanges(),t.addRange(s),this.range=s,!0;return!1},applyHighlight:function(t,e){var n=["tc-highlight-true","tc-highlight-false"],i=e?0:1;t.classList.contains(n[i])||(t.classList.add(n[i]),t.classList.remove(n[1-i])),t.addEventListener("click",this.clickToShow)},removeHighlight:function(t){for(var e=g.a.createRange(),n=t.parentNode;t.firstChild;){var i=t.firstChild;n.insertBefore(i,t),e.selectNode(i)}n.removeChild(t),e.normalizeBoundaries()},updateTargetData:function(t,e,n,i){t.dataset.tcTrue=e||this.numTrue,t.dataset.tcFalse=n||this.numFalse,t.dataset.tcUser=i||this.state},targetFromRange:function(t){if(null!==t){var e=document.createElement("span");return t.splitBoundaries(),e.appendChild(t.extractContents()),t.insertNode(e),e.classList.add("tc-highlight"),e}return null},highlightExistingSentences:function(t){for(var e in t){var n=t[e].votes,i=t[e].text,o=g.a.createRange();if(o.findText(i),!o.collapsed){var s=this.targetFromRange(o);this.applyHighlight(s,n[0]>=n[1]),this.updateTargetData(s,n[0],n[1],n[2])}}},removeAllHighlightSentences:function(){var t=document.querySelectorAll(".tc-highlight"),e=!0,n=!1,i=void 0;try{for(var o,s=c()(t);!(e=(o=s.next()).done);e=!0){var a=o.value;this.removeHighlight(a)}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}},collectAllSentences:function(){var t=g.a.createRange();t.selectNode(document.body);var e=new a.a(t.text().match(/[^.!?\s][^\n.!?]*\b[^.!?\s][^\n.!?]*\b[^.!?\s][^\n.!?]*(?:[.!?](?!['"]?\s|$)[^\n.!?]*)*[.!?]?['"]?(?=\s|$)/g));return[].concat(o()(e))}}}},tvR6:function(t,e){},wxXY:function(t,e,n){e=t.exports=n("FZ+f")(!1),e.push([t.i,"\n#tc-popbar{position:absolute;height:35px;min-width:-webkit-min-content;min-width:-moz-min-content;min-width:min-content;line-height:35px;z-index:9999\n}\n.tc-highlight:hover{background-color:yellow;transition:background-color 0.2s ease-in-out\n}\n.tc-highlight-true{background-color:rgba(235,196,124,0.5);transition:background-color 0.2s ease-in-out\n}\n.tc-highlight-false{background-color:rgba(128,128,128,0.5);transition:background-color 0.2s ease-in-out\n}\n.tc-button{height:35px;position:absolute;padding-left:10px;padding-right:10px;padding-top:5px;padding-bottom:5px;font-size:16px;font-family:'Bookman Old Style', serif;border-color:black;opacity:0.7\n}\n.tc-button:focus{border-color:black;box-shadow:0 0 0 black\n}\n.tc-button:hover{border-color:black;opacity:1\n}\n.tc-button-toggle{border-color:black;opacity:1\n}\n#tc-button-true{right:50%;border-radius:500px 0 0 500px;margin-right:0;background:orange;color:#000\n}\n#tc-button-false{left:50%;border-radius:0 500px 500px 0;margin-left:0;background:#000;color:orange\n}\n",""])}},["Uy9U"]);